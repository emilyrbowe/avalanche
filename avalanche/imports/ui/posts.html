<template name="post_list">
	<div class="posts">
		{{#each posts}}
			{{> post}}
		{{/each}}
	</div>
</template>

<template name="post">
	<div class="post">
		<div class="posters posters-{{mediaCount}}">
			{{> post_poster _id=_id cloudinary_media=cloudinary_media.[0]}}
			{{> post_poster _id=_id cloudinary_media=cloudinary_media.[1]}}
			{{> post_poster _id=_id cloudinary_media=cloudinary_media.[2]}}
		</div>

		<div class="info post-info">
			{{#if inspiration_url}}
				<div class="inspiration">
					<span class="">Inspired by</span>
					<a href="{{inspiration_url}}">{{inspiration_name}}</a>
				</div>
			{{/if}}

			{{#if description}}
				<div class="description copy">
					{{#markdown}}{{formatDescription 100 description}}{{/markdown}}
				</div>
			{{/if}}

			<div class="group">
				<span class="author">
					{{#if authorHeadshot}}
						<img class="headshot" src="{{c.url authorHeadshot gravity='face' width=100 height=100 quality=100 crop='fill'}}" alt=""/>
					{{else}}
						<img class="headshot" src="/images/avatar.png"/>
					{{/if}}
					<span class="name">{{author}}</span>
				</span>

				<span class="date">
					{{formatDate created_at}},
					{{formatTime created_at}}
				</span>
			</div>
		</div>

		<div class="actions">
			{{#if userCanEdit}}
				<i class="action-button right remove-post fa fa-trash" aria-hidden="true"></i>
				<i class="action-button right edit-post fa fa-pencil" aria-hidden="true"></i>
			{{else}}
				<span class="no-actions">No Actions Available</span>
			{{/if}}
		</div>

	</div>
</template>

<template name="post_poster">
	{{#if equals cloudinary_media.resource_type "video"}}
		<div class="poster-link" href="/posts/{{_id}}">
			<video src="http://res.cloudinary.com/jbakse/video/upload/w_400/{{cloudinary_media.public_id}}.mp4" autoplay=true loop=true muted=true></video>
		</div>
	{{/if}}
	{{#if equals cloudinary_media.resource_type "image"}}
		<div class="poster-link" href="/posts/{{_id}}">
			<img src="{{c.url cloudinary_media.public_id width=400 crop='fill' quality=90}}" alt=""/>
		</div>
	{{/if}}
</template>

<template name="edit_post_form">
	<div id="edit-post-form" class="overlay">
		<div class="overlay-form">
			<div class="title-bar">Edit Post</div>
			<div class="content">

				<!-- <div class="media-progress" style="width:30%"></div> -->

				{{#if progress}}
					<div class="media-progress" style="width:{{progress}}%"></div>
				{{/if}}

				<div class="posters">
					<div class="poster-wrap">
						<label for="upload-file-0" class="upload">
							<i class="fa fa-cloud-upload fa-lg" aria-hidden="true"></i>
							<br/>Upload Media
						</label>

						{{#if equals post.cloudinary_media.[0].resource_type "video"}}
							<video src="http://res.cloudinary.com/jbakse/video/upload/w_400/{{post.cloudinary_media.[0].public_id}}.mp4" autoplay=true loop=true muted=true></video>
						{{/if}}
						{{#if equals post.cloudinary_media.[0].resource_type "image"}}
							<img src="{{c.url post.cloudinary_media.[0].public_id height=250 crop='fill' quality=90}}" alt=""/>
						{{/if}}

						{{#if post.cloudinary_media.[0].resource_type}}
							<div class="info">
								<div class="dimensions">
									{{post.cloudinary_media.[0].width}}x{{post.cloudinary_media.[0].height}}
								</div>
								<span class="icon-button remove remove-file-0">
									<i class="fa fa-times-circle" aria-hidden="true"></i>
								</span>
							</div>
						{{/if}}
					</div>
					<div class="poster-wrap">
						<label for="upload-file-1" class="upload">
							<i class="fa fa-cloud-upload fa-lg" aria-hidden="true"></i>
							<br/>Upload Media

						</label>

						{{#if equals post.cloudinary_media.[1].resource_type "video"}}
							<video src="http://res.cloudinary.com/jbakse/video/upload/w_400/{{post.cloudinary_media.[1].public_id}}.mp4" autoplay=true loop=true muted=true></video>
						{{/if}}
						{{#if equals post.cloudinary_media.[1].resource_type "image"}}
							<img src="{{c.url post.cloudinary_media.[1].public_id height=250 crop='fill' quality=90}}" alt=""/>
						{{/if}}

						{{#if post.cloudinary_media.[1].resource_type}}
							<div class="info">
								<div class="dimensions">
									{{post.cloudinary_media.[1].width}}x{{post.cloudinary_media.[1].height}}
								</div>
								<span class="icon-button remove remove-file-1">
									<i class="fa fa-times-circle" aria-hidden="true"></i>
								</span>
							</div>
						{{/if}}

					</div>
					<div class="poster-wrap">
						<label for="upload-file-2" class="upload">
							<i class="fa fa-cloud-upload fa-lg" aria-hidden="true"></i>
							<br/>Upload Media
						</label>

						{{#if equals post.cloudinary_media.[2].resource_type "video"}}
							<video src="http://res.cloudinary.com/jbakse/video/upload/w_400/{{post.cloudinary_media.[2].public_id}}.mp4" autoplay=true loop=true muted=true></video>
						{{/if}}
						{{#if equals post.cloudinary_media.[2].resource_type "image"}}
							<img src="{{c.url post.cloudinary_media.[2].public_id height=250 crop='fill' quality=90}}" alt=""/>
						{{/if}}
						{{#if post.cloudinary_media.[2].resource_type}}
							<div class="info">
								<div class="dimensions">
									{{post.cloudinary_media.[2].width}}x{{post.cloudinary_media.[2].height}}
								</div>
								<span class="icon-button remove remove-file-2">
									<i class="fa fa-times-circle" aria-hidden="true"></i>
								</span>
							</div>
						{{/if}}
					</div>
				</div>

				<input class="upload-file-0 hidden" id="upload-file-0" name="upload-file-0" type="file">
				<input class="upload-file-1 hidden" id="upload-file-1" name="upload-file-1" type="file">
				<input class="upload-file-2 hidden" id="upload-file-2" name="upload-file-2" type="file">

				{{#autoForm collection="Posts" doc=post id="updatePostForm" type="update"}}
					{{> afQuickField name='lesson' options=lessons}}

					<div class="group">
						<!-- <div class="inspiration inspiration_name"> -->
						{{> afQuickField name='inspiration_name' placeholder='Inspiration Name'}}
						<!-- </div> -->

						<!-- <div class="inspiration inspiration_url"> -->
						{{> afQuickField name='inspiration_url' placeholder='Paste URL here'}}
						<!-- </div> -->

					</div>

					<!-- <div class="inspiration inspiration-button">
						+
					</div> -->

					{{> afQuickField name='description' rows=6 placeholder='Description'}}

					<!-- {{> afQuickField name='lesson' options=lessons}} -->
					<!-- {{> afQuickField name='inspiration_name'}}
					{{> afQuickField name='inspiration_url'}}
					{{> afQuickField name='description' rows=6}} -->

					<!-- {{> afQuickField name='posted'}} -->

					{{#with post}}
						<div class="submit-cancel-container">
							<button type="submit" class="submit btn btn-primary">Update</button>
							<button type="button" class="cancel btn">Cancel</button>
						</div>
					{{/with}}
				{{/autoForm}}

			</div>

		</div>
	</div>
</template>

<template name="post_overlay">
	<div id="post-overlay" class="overlay">
		<div class="overlay-content">
			<div class="media">
				{{#if equals post.cloudinary_media.[0].resource_type "video"}}
					<video src="http://res.cloudinary.com/jbakse/video/upload/{{post.cloudinary_media.[0].public_id}}.mp4" controls=true autoplay=true loop=true></video>
				{{/if}}
				{{#if equals post.cloudinary_media.[0].resource_type "image"}}
					<img class="poster" src="{{c.url post.cloudinary_media.[0].public_id}}" alt=""/>
				{{/if}}

				{{#if equals post.cloudinary_media.[1].resource_type "video"}}
					<video src="http://res.cloudinary.com/jbakse/video/upload/{{post.cloudinary_media.[1].public_id}}.mp4" controls=true autoplay=true loop=true muted=true></video>
				{{/if}}
				{{#if equals post.cloudinary_media.[1].resource_type "image"}}
					<img class="poster" src="{{c.url post.cloudinary_media.[1].public_id}}" alt=""/>
				{{/if}}

				{{#if equals post.cloudinary_media.[2].resource_type "video"}}
					<video src="http://res.cloudinary.com/jbakse/video/upload/{{post.cloudinary_media.[2].public_id}}.mp4" controls=true autoplay=true loop=true muted=true></video>
				{{/if}}
				{{#if equals post.cloudinary_media.[2].resource_type "image"}}
					<img class="poster" src="{{c.url post.cloudinary_media.[2].public_id}}" alt=""/>
				{{/if}}
			</div>

			<div class="info post-info">
				<div class="actions">
					<!-- <i class="action-button previous-post fa fa-arrow-left" aria-hidden="true"></i> -->
					<!-- <i class="action-button next-post fa fa-arrow-right" aria-hidden="true"></i> -->
					<i class="action-button close-overlay fa fa-times right" aria-hidden="true"></i>
				</div>
				<div class="group">
					<span class="author">
						{{#with post}}
							{{#if authorHeadshot}}
								<img class="headshot" src="{{c.url authorHeadshot gravity='face' width=100 height=100 quality=100 crop='fill'}}" alt=""/>
							{{else}}
								<img class="headshot" src="/images/avatar.png"/>
							{{/if}}
						{{/with}}
						<span class="name">{{post.author}}</span>
					</span>

					<span class="date">
						{{formatDate post.created_at}},
						{{formatTime post.created_at}}
					</span>
				</div>

				{{#if post.inspiration_url}}
					<div class="inspiration">
						<span class="">Inspired by</span>
						<a href="{{inspiration_url}}">{{post.inspiration_name}}</a>
					</div>
				{{/if}}

				{{#if post.description}}
					<div class="description copy">
						{{#markdown}}{{formatDescription 10000 post.description}}{{/markdown}}
					</div>
				{{/if}}

			</div>

		</div>
	</div>
</template>
