<template name="post_list">
	<div class="posts">
		{{#each posts}}
			{{> post}}
		{{/each}}
	</div>
</template>

<template name="post">
	<div class="post">

		{{> post_poster _id=_id cloudinary_media=cloudinary_media.[0]}}
		{{> post_poster _id=_id cloudinary_media=cloudinary_media.[1]}}
		{{> post_poster _id=_id cloudinary_media=cloudinary_media.[2]}}
		<div class="info">
			{{#if inspiration_url}}
				<div class="inspiration">
					<span class="">Inspired by:
					</span>
					<a href="{{inspiration_url}}">{{inspiration_name}}</a>
				</div>
			{{/if}}

			<div class="author">
				{{author}}
			</div>

			<div class="date">
				{{formatDate created_at}},
				{{formatTime created_at}}
			</div>
		</div>

		<div class="actions">
			<button class="btn btn-default remove-post">
				<i class="fa fa-trash" aria-hidden="true"></i>
			</button>
			<button class="btn btn-default edit-post">
				<i class="fa fa-pencil" aria-hidden="true"></i>
			</button>
		</div>

	</div>
</template>

<template name="post_poster">
	{{#if equals cloudinary_media.resource_type "video"}}
		<div class="poster-link" href="/posts/{{_id}}">
			<video src="http://res.cloudinary.com/jbakse/video/upload/w_400/{{cloudinary_media.public_id}}.mp4" autoplay=true loop=true muted=true></video>
		</div>
	{{/if}}
	{{#if equals cloudinary_media.resource_type "image"}}
		<div class="poster-link" href="/posts/{{_id}}">
			<img src="{{c.url cloudinary_media.public_id width=400 crop='fill' quality=90}}" alt=""/>
		</div>
	{{/if}}
</template>

<template name="edit_post_form">
	<div id="edit-post-form" class="overlay">
		<div class="overlay-form">
			<div class="title-bar">Edit Post
				{{post_id}}
			</div>
			<div class="content">

				<!-- media item 0 -->
				<div class="poster-wrap">
					{{#if equals post.cloudinary_media.[0].resource_type "video"}}
						<video src="http://res.cloudinary.com/jbakse/video/upload/w_400/{{post.cloudinary_media.[0].public_id}}.mp4" autoplay=true loop=true></video>
					{{/if}}
					{{#if equals post.cloudinary_media.[0].resource_type "image"}}
						<img src="{{c.url post.cloudinary_media.[0].public_id height=250 crop='fill' quality=90}}" alt=""/>
					{{/if}}
				</div>
				{{#if post.cloudinary_media.[0].resource_type}}
					<button class="btn remove-file-0">
						Remove Image
					</button>
				{{/if}}
				<label for="upload-file-0" class="button">
					<!-- <i class="fa fa-cloud-upload fa-lg" aria-hidden="true"></i> Upload File 0 -->
					<div class="upload-file-container">
						<i class="fa fa-cloud-upload fa-lg" aria-hidden="true"></i>
						<div class="drag-drop-browse">Drag files here or
							<span class="browse">browse</span>
						</div>
					</div>
				</label>
				<input class="upload-file-0 hidden" id="upload-file-0" name="upload-file-0" type="file">

				<!-- media item 1 -->
				<div class="poster-wrap">
					{{#if equals post.cloudinary_media.[1].resource_type "video"}}
						<video src="http://res.cloudinary.com/jbakse/video/upload/w_400/{{post.cloudinary_media.[1].public_id}}.mp4" autoplay=true loop=true></video>
					{{/if}}
					{{#if equals post.cloudinary_media.[1].resource_type "image"}}
						<img src="{{c.url post.cloudinary_media.[1].public_id height=250 crop='fill' quality=90}}" alt=""/>
					{{/if}}
				</div>
				{{#if post.cloudinary_media.[1].resource_type}}
					<button class="btn remove-file-1">
						Remove Image
					</button>
				{{/if}}
				<label for="upload-file-1" class="button">
					<!-- <i class="fa fa-cloud-upload fa-lg" aria-hidden="true"></i> Upload File 1 -->
					<div class="upload-file-container">
						<i class="fa fa-cloud-upload fa-lg" aria-hidden="true"></i>
						<div class="drag-drop-browse">Drag files here or
							<span class="browse">browse</span>
						</div>
					</div>
				</label>
				<input class="upload-file-1 hidden" id="upload-file-1" name="upload-file-1" type="file">

				<!-- media item 2 -->
				<div class="poster-wrap">
					{{#if equals post.cloudinary_media.[2].resource_type "video"}}
						<video src="http://res.cloudinary.com/jbakse/video/upload/w_400/{{post.cloudinary_media.[2].public_id}}.mp4" autoplay=true loop=true></video>
					{{/if}}
					{{#if equals post.cloudinary_media.[2].resource_type "image"}}
						<img src="{{c.url post.cloudinary_media.[2].public_id height=250 crop='fill' quality=90}}" alt=""/>
					{{/if}}
				</div>
				{{#if post.cloudinary_media.[2].resource_type}}
					<button class="btn remove-file-2">
						Remove Image
					</button>
				{{/if}}
				<label for="upload-file-2" class="button">
					<!-- <i class="fa fa-cloud-upload fa-lg" aria-hidden="true"></i> Upload File 2 -->
					<div class="upload-file-container">
						<i class="fa fa-cloud-upload fa-lg" aria-hidden="true"></i>
						<div class="drag-drop-browse">Drag files here or
							<span class="browse">browse</span>
						</div>
					</div>
				</label>
				<input class="upload-file-2 hidden" id="upload-file-2" name="upload-file-2" type="file">

				{{#autoForm collection="Posts" doc=post id="updatePostForm" type="update"}}
					{{> afQuickField name='lesson' options=lessons}}

					<div class="inspiration inspiration_name">
						{{> afQuickField name='inspiration_name' placeholder='Inspiration Name'}}
					</div>

					<div class="inspiration inspiration_url">
						{{> afQuickField name='inspiration_url' placeholder='Paste URL here'}}
					</div>

					<div class="inspiration inspiration-button">
						+
					</div>

					{{> afQuickField name='description' rows=6 placeholder='Description'}}

					<!-- {{> afQuickField name='lesson' options=lessons}} -->
					<!-- {{> afQuickField name='inspiration_name'}}
					{{> afQuickField name='inspiration_url'}}
					{{> afQuickField name='description' rows=6}} -->

					<!-- {{> afQuickField name='posted'}} -->

					{{#with post}}
						<div class="submit-cancel-container">
							<button type="submit" class="submit btn btn-primary">Update</button>
							<button type="button" class="cancel btn">Cancel</button>
						</div>
					{{/with}}
				{{/autoForm}}

			</div>

		</div>
	</div>
</template>

<template name="post_overlay">
	<div id="post-overlay" class="overlay">
		<div class="overlay-content">

			<div class="name-value">
				<span class="name">Author</span>
				<span class="value">
					<a href="/users/{{post.author_id}}">{{post.author}}</a>
				</span>
			</div>
			<div class="name-value">
				<span class="name">Posted</span>
				<span class="value">{{formatDate post.created_at}},
					{{formatTime post.created_at}}</span>
			</div>

			{{#if equals post.cloudinary_media.[0].resource_type "video"}}
				<video src="http://res.cloudinary.com/jbakse/video/upload/{{post.cloudinary_media.[0].public_id}}.mp4" controls=true autoplay=true loop=true></video>
			{{/if}}
			{{#if equals post.cloudinary_media.[0].resource_type "image"}}
				<img class="poster" src="{{c.url post.cloudinary_media.[0].public_id}}" alt=""/>
			{{/if}}

			{{#if equals post.cloudinary_media.[1].resource_type "video"}}
				<video src="http://res.cloudinary.com/jbakse/video/upload/{{post.cloudinary_media.[1].public_id}}.mp4" controls=true autoplay=true loop=true></video>
			{{/if}}
			{{#if equals post.cloudinary_media.[1].resource_type "image"}}
				<img class="poster" src="{{c.url post.cloudinary_media.[1].public_id}}" alt=""/>
			{{/if}}

			{{#if equals post.cloudinary_media.[2].resource_type "video"}}
				<video src="http://res.cloudinary.com/jbakse/video/upload/{{post.cloudinary_media.[2].public_id}}.mp4" controls=true autoplay=true loop=true></video>
			{{/if}}
			{{#if equals post.cloudinary_media.[2].resource_type "image"}}
				<img class="poster" src="{{c.url post.cloudinary_media.[2].public_id}}" alt=""/>
			{{/if}}

		</div>
	</div>
</template>
